<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>McTool - Prüfungsverwaltung</title>

    <!--bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <!-- jquerry-->
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script -->

     <!--font-awesome-icons-->   
    <script src="https://kit.fontawesome.com/3d2d5ca0b3.js" crossorigin="anonymous"></script>

    <!--css-stylesheet-->
    <link href="./verwaltung.css" rel="stylesheet">

    <script>
        //Funktion, um den Cookie auszulesen
        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for(let i = 0; i <ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
                }
            }
            return "";
}

        // Überprüfe, ob der 'role'-Cookie gesetzt ist
        const cookie = getCookie("role");

        if (cookie != "teacher") {
            window.location = "../login/forbidden.html"
        }
    </script>

</head>
<body>
    <div class="container-fluid" id="content-wrapper">
        <div class="row" id="top-bar-row">
            <h1>Prüfungsverwaltung</h1>
        </div>

        <div class="container main-content-wrapper">
            <div class="row full-width">
                <p class="subtitle ">Welche Prüfungsergebnisse möchten Sie sehen?</p>
                <div class="container filter-wrapper">
                  <div class="filter-col">
                    <label>Bitte wählen Sie eine Prüfung aus der Liste aus: </label>
                      <select id="examFilter" style="margin: 0 10px 0 10px">
                        <option selected disabled>Prüfung auswählen</option>
                        <!-- Options will be dynamically generated by JavaScript -->
                      </select>
                </div> 

                <div class="filter-col mt-2">
                    <label>oder suchen Sie nach der gewünschten Prüfungsbezeichnung: </label>
                    <input id="searchInput" style="margin: 0 10px 0 10px; width: 250px" type="text" placeholder="Prüfungsbezeichnung eingeben...">
                    <button id="searchButton" class="btn btn-light">Suchen</button>
                </div>
            </div>
            <!--Die Tabelle erstmal versteckt-->
            <div class="row table-content-row">
              <div class="table-wrapper">
                  <table class="table table-striped mt-5" id="resultsTable">
                      <thead>
                        <tr>
                          <th scope="col">Teilnehmer</th>
                          <th scope="col">Klasse</th>
                          <th scope="col">Ergebnis</th>
                        </tr>
                      </thead>
                      <tbody>
                        <!-- Rows will be inserted here by JavaScript -->
                      </tbody>
                    </table>
              </div>
        </div>

    </div>

    <!--bootstrap-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

<!-- <script>

  const results = [
      { name: "Marko Poldi", class: "FI203", score: 56 },
      { name: "Cristiano Kolumbus", class: "FI203", score: 73 },
      { name: "Ferdi Magellan", class: "FI203", score: 86 }
  ];

  const tableBody = document.querySelector("#resultsTable tbody");

  function populateTable() {
      results.forEach(result => {
          const row = document.createElement("tr");

          const nameCell = document.createElement("td");
          nameCell.textContent = result.name;
          row.appendChild(nameCell);

          const classCell = document.createElement("td");
          classCell.textContent = result.class;
          row.appendChild(classCell);

          const scoreCell = document.createElement("td");
          scoreCell.textContent = result.score;
          row.appendChild(scoreCell);

          tableBody.appendChild(row);
      });
  }

  populateTable();
</script> -->

<script>
  document.addEventListener("DOMContentLoaded", () => {
      const results = [
          { name: "Marko Polski", class: "FI203", score: 56, exam: "FI203-FU0-11-24" },
          { name: "Cristiano Kolumbus", class: "FI203", score: 73, exam: "FI203-FU0-11-25" },
          { name: "Ferdi Magellan", class: "FI203", score: 86, exam: "TH-FI211-WebApi" },
          { name: "John Doe", class: "FI211", score: 90, exam: "TH-FI211-WebApi" },
          { name: "Jane Doe", class: "FI211", score: 45, exam: "Vorgangsbeschreibung" }
      ];


      const tableBody = document.querySelector("#resultsTable tbody");
      const examFilter = document.getElementById("examFilter");

      function populateTable(data) {
          tableBody.innerHTML = "";
          data.forEach(result => {
              const row = document.createElement("tr");

              const nameCell = document.createElement("td");
              nameCell.textContent = result.name;
              row.appendChild(nameCell);

              const classCell = document.createElement("td");
              classCell.textContent = result.class;
              row.appendChild(classCell);

              const scoreCell = document.createElement("td");
              scoreCell.textContent = result.score;
              row.appendChild(scoreCell);

              tableBody.appendChild(row);
          });
      }

      function generateExamOptions() {
          const uniqueExams = [...new Set(results.map(result => result.exam))]; 
          uniqueExams.forEach(exam => {
              const option = document.createElement("option");
              option.value = exam;
              option.textContent = exam;
              examFilter.appendChild(option);
          });
      }

      function filterByExam(exam) {
          const filteredResults = results.filter(result => result.exam === exam);
          populateTable(filteredResults);
      }

      function filterBySearch(query) {
          const filteredResults = results.filter(result =>
              result.name.toLowerCase().includes(query.toLowerCase()) ||
              result.class.toLowerCase().includes(query.toLowerCase()) ||
              result.exam.toLowerCase().includes(query.toLowerCase())
          );
          populateTable(filteredResults);
      }

      if (examFilter) {
          examFilter.addEventListener("change", (event) => {
              const selectedExam = event.target.value;
              if (selectedExam) {
                  filterByExam(selectedExam);
              }
          });
      }

      const searchButton = document.getElementById("searchButton");
      const searchInput = document.getElementById("searchInput");

      if (searchButton) {
          searchButton.addEventListener("click", () => {
              const searchQuery = searchInput.value;
              filterBySearch(searchQuery);
          });
      }

      if (searchInput) {
          searchInput.addEventListener("keyup", (event) => {
              if (event.key === "Enter") {
                  const searchQuery = event.target.value;
                  filterBySearch(searchQuery);
              }
          });
      }

      generateExamOptions();
      populateTable(results);
  });
</script>